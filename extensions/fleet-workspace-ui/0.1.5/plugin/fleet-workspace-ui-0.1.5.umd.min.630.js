(("undefined"!==typeof self?self:this)["webpackChunkfleet_workspace_ui_0_1_5"]=("undefined"!==typeof self?self:this)["webpackChunkfleet_workspace_ui_0_1_5"]||[]).push([[630],{14854:function(e,t,a){var l=a(71942);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var n=a(74825).A;n("728bb12b",l,!0,{sourceMap:!1,shadowMode:!1})},35630:function(e,t,a){"use strict";a.d(t,{A:function(){return y}});var l=a(9274);const n={key:0,class:"search-slot"},i={key:1},r={class:"search-slot"};function o(e,t,a,o,s,c){const p=(0,l.resolveComponent)("Principal"),d=(0,l.resolveComponent)("LabeledSelect"),u=(0,l.resolveDirective)("clean-tooltip");return(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createBlock)(d,{ref:"labeled-select",value:s.newValue,"onUpdate:value":[t[0]||(t[0]=e=>s.newValue=e),c.add],mode:a.mode,label:c.label,placeholder:c.placeholder,options:s.options,searchable:!0,filterable:!1,class:(0,l.normalizeClass)(["select-principal",{"retain-selection":a.retainSelection}]),onSearch:c.onSearch,onOnOpen:t[1]||(t[1]=e=>c.resetTooltipContent()),onOnClose:t[2]||(t[2]=e=>c.setTooltipContent())},(0,l.createSlots)({"no-options":(0,l.withCtx)((({searching:t})=>[t?((0,l.openBlock)(),(0,l.createElementBlock)("span",n,(0,l.toDisplayString)(e.t("cluster.memberRoles.addClusterMember.noResults")),1)):((0,l.openBlock)(),(0,l.createElementBlock)("div",i,[(0,l.createElementVNode)("em",r,(0,l.toDisplayString)(e.t("cluster.memberRoles.addClusterMember.searchPlaceholder")),1)]))])),option:(0,l.withCtx)((e=>[(0,l.createVNode)(p,{value:e.label,"use-muted":!1},null,8,["value"])])),_:2},[a.retainSelection?{name:"selected-option",fn:(0,l.withCtx)((e=>[(0,l.createVNode)(p,{value:e.label,"use-muted":!1,class:"mt-10 mb-10"},null,8,["value"])])),key:"0"}:void 0]),1032,["value","mode","label","placeholder","options","class","onUpdate:value","onSearch"])),[[u,{content:s.tooltipContent,placement:"bottom",popperClass:["select-principal-tooltip"]}]])}var s=a(88697),c=a(44307),p=a(12784),d=a.n(p),u=a(14220),m=a(35664),h={emits:["add"],components:{LabeledSelect:s.A,Principal:c.A},props:{mode:{type:String,default:u.G5},showMyGroupTypes:{type:Array,default(e){return["group","user"]}},searchGroupTypes:{type:String,default:null,validator(e){return null===e||"group"===e||"user"===e}},retainSelection:{type:Boolean,default:!1},project:{type:Boolean,default:!1}},async fetch(){this.principals=await this.$store.dispatch("rancher/findAll",{type:m.k$.PRINCIPAL,opt:{url:"/v3/principals"}}),this.options=this.suggested},data(){return{principals:null,searchStr:"",options:[],newValue:"",tooltipContent:null}},computed:{suggested(){const e=this.principals.filter((e=>!!e.memberOf&&!!this.showMyGroupTypes.includes(e.principalType))).sort(((e,t)=>e.name.localeCompare(t.name))).map((e=>e.id));return e},label(){return this.retainSelection?this.t("cluster.memberRoles.addClusterMember.labelSelect"):this.t("cluster.memberRoles.addClusterMember.labelAdd")},placeholder(){return this.project?this.t("projectMembers.projectPermissions.searchForMember"):this.t("cluster.memberRoles.addClusterMember.placeholder")}},created(){this.debouncedSearch=d()(this.search,200)},methods:{setTooltipContent(){if(this.retainSelection)if(this.principals){const e=this.principals.find((e=>e.id===this.newValue));this.tooltipContent=e?.name}else this.tooltipContent=null},resetTooltipContent(){this.retainSelection&&(this.tooltipContent=null)},add(e){e&&(this.$emit("add",e),this.retainSelection||(this.newValue=""))},onSearch(e,t){e=(e||"").trim(),this.searchStr=e,e?(t(!0),this.debouncedSearch(e,t)):this.search(null,t)},async search(e,t){if(!e)return this.options=this.suggested.slice(),void t(!1);try{const t=await this.$store.dispatch("rancher/collectionAction",{type:m.k$.PRINCIPAL,actionName:"search",opt:{url:"/v3/principals?action=search"},body:{name:e,principalType:this.searchGroupTypes}});this.searchStr===e&&(this.options=t.map((e=>e.id)))}catch(a){this.options=[]}finally{t(!1)}}}},v=(a(53300),a(14854),a(47433));const g=(0,v.A)(h,[["render",o],["__scopeId","data-v-dd5e86d0"]]);var y=g},44307:function(e,t,a){"use strict";a.d(t,{A:function(){return g}});var l=a(9274);const n={class:"avatar"},i=["src"],r={key:0,class:"name"},o={class:"name"},s={class:"avatar"},c={class:"name text-error"};function p(e,t,a,p,d,u){const m=(0,l.resolveDirective)("clean-html"),h=(0,l.resolveDirective)("t");return(0,l.openBlock)(),(0,l.createElementBlock)("div",{class:(0,l.normalizeClass)(["principal",{showLabels:a.showLabels}])},[!d.principal&&e.$fetchState.pending?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[t[0]||(t[0]=(0,l.createElementVNode)("div",{class:"avatar"},[(0,l.createElementVNode)("div",{class:"empty"},[(0,l.createElementVNode)("i",{class:"icon icon-spinner icon-lg"})])],-1)),(0,l.withDirectives)((0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["name",{"text-muted":a.useMuted}])},null,2),[[m,e.t("principal.loading",null,!0)]]),t[1]||(t[1]=(0,l.createElementVNode)("div",{class:"description"},null,-1))],64)):d.principal?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createElementVNode)("div",n,[(0,l.createElementVNode)("img",{src:d.principal.avatarSrc,class:(0,l.normalizeClass)({round:d.principal.roundAvatar})},null,10,i)]),a.showLabels?((0,l.openBlock)(),(0,l.createElementBlock)("div",r,[(0,l.createElementVNode)("table",null,[(0,l.createElementVNode)("tbody",null,[(0,l.createElementVNode)("tr",null,[(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.t("principal.name"))+": ",1),(0,l.createElementVNode)("td",null,(0,l.toDisplayString)(d.principal.name||d.principal.loginName),1)]),(0,l.createElementVNode)("tr",null,[(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.t("principal.loginName"))+": ",1),(0,l.createElementVNode)("td",null,(0,l.toDisplayString)(d.principal.loginName),1)]),(0,l.createElementVNode)("tr",null,[(0,l.createElementVNode)("th",null,(0,l.toDisplayString)(e.t("principal.type"))+": ",1),(0,l.createElementVNode)("td",null,(0,l.toDisplayString)(d.principal.displayType),1)])])])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createElementVNode)("div",o,[u.showBoth?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createTextVNode)((0,l.toDisplayString)(d.principal.name)+" ",1),d.principal.loginName?((0,l.openBlock)(),(0,l.createElementBlock)("span",{key:0,class:(0,l.normalizeClass)({"text-muted":a.useMuted})},"("+(0,l.toDisplayString)(d.principal.loginName)+")",3)):(0,l.createCommentVNode)("",!0)],64)):d.principal.name?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createTextVNode)((0,l.toDisplayString)(d.principal.name),1)],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createTextVNode)((0,l.toDisplayString)(d.principal.loginName),1)],64))]),(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["description",{"text-muted":a.useMuted}])},(0,l.toDisplayString)(d.principal.displayType),3)],64))],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createElementVNode)("div",s,[(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["empty",{"text-muted":a.useMuted}])},t[2]||(t[2]=[(0,l.createElementVNode)("i",{class:"icon icon-warning icon-lg"},null,-1)]),2)]),(0,l.withDirectives)((0,l.createElementVNode)("div",c,null,512),[[h,"principal.error"]]),(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["description",{"text-muted":a.useMuted}])},(0,l.toDisplayString)(a.value),3)],64))],2)}var d=a(35664),u=a(4364),m={props:{value:{type:String,required:!0},useMuted:{type:Boolean,default:!0},showLabels:{type:Boolean,default:!1}},async fetch(){this.loadData()},data(){return{principal:null}},computed:{showBoth(){const e=this.principal;return e.name&&e.loginName&&e.name.trim().toLowerCase()!==e.loginName.trim().toLowerCase()}},methods:{async loadData(){if(this.principal=this.$store.getters["rancher/byId"](d.k$.PRINCIPAL,this.value),this.principal)return;const e=escape(this.value).replace(/\//g,"%2F");try{this.principal=await this.$store.dispatch("rancher/find",{type:d.k$.PRINCIPAL,id:this.value,opt:{url:`/v3/principals/${e}`}})}catch(t){u.error("Failed to fetch principal",this.value,e)}}},watch:{value(){this.loadData()}}},h=(a(87235),a(47433));const v=(0,h.A)(m,[["render",p],["__scopeId","data-v-7e5b3098"]]);var g=v},53300:function(e,t,a){var l=a(65076);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var n=a(74825).A;n("24530cbf",l,!0,{sourceMap:!1,shadowMode:!1})},65076:function(e,t,a){"use strict";a.r(t);var l=a(36758),n=a.n(l),i=a(40935),r=a.n(i),o=r()(n());o.push([e.id,".search-slot[data-v-dd5e86d0]{color:var(--body-text)}.select-principal.retain-selection[data-v-dd5e86d0]{min-height:91px}.select-principal.retain-selection.focused .principal[data-v-dd5e86d0]{display:none}",""]),t["default"]=o},71942:function(e,t,a){"use strict";a.r(t);var l=a(36758),n=a.n(l),i=a(40935),r=a.n(i),o=r()(n());o.push([e.id,".vs__dropdown-menu{width:0}.vs__dropdown-menu *{overflow-x:hidden;text-overflow:ellipsis}.select-principal-tooltip{max-width:580px;word-wrap:break-word}",""]),t["default"]=o},87235:function(e,t,a){var l=a(88675);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var n=a(74825).A;n("8ead1808",l,!0,{sourceMap:!1,shadowMode:!1})},88675:function(e,t,a){"use strict";a.r(t);var l=a(36758),n=a.n(l),i=a(40935),r=a.n(i),o=r()(n());o.push([e.id,'.principal[data-v-7e5b3098]{display:grid;grid-template-areas:"avatar name" "avatar description";grid-template-columns:40px auto;grid-template-rows:auto 20px;-moz-column-gap:10px;column-gap:10px}.principal th[data-v-7e5b3098]{text-align:left;font-weight:400;padding-right:10px}.principal.showLabels[data-v-7e5b3098]{grid-template-areas:"avatar name";grid-template-columns:60px auto;grid-template-rows:60px;-moz-column-gap:0;column-gap:0}.principal.showLabels .name[data-v-7e5b3098]{line-height:unset}.principal.showLabels table tr td[data-v-7e5b3098]:not(:first-of-type){padding-left:10px}.principal .avatar[data-v-7e5b3098]{grid-area:avatar;text-align:center}.principal .avatar DIV.empty[data-v-7e5b3098]{border:1px solid var(--border);line-height:40px}.principal .avatar IMG[data-v-7e5b3098]{width:40px;height:40px}.principal .avatar DIV.round[data-v-7e5b3098],.principal .avatar IMG.round[data-v-7e5b3098]{border-radius:50%}.principal .name[data-v-7e5b3098]{grid-area:name;line-height:20px;overflow-wrap:anywhere}.principal .description[data-v-7e5b3098]{grid-area:description;line-height:20px}',""]),t["default"]=o}}]);
//# sourceMappingURL=fleet-workspace-ui-0.1.5.umd.min.630.js.map